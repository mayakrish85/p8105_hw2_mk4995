---
title: "P8105 Homework 2"
author: "Maya Krishnamoorthy"
date: "2024-09-25"
output: github_document
---

``` {r setup, echo=FALSE, message=FALSE}
library(tidyverse)
library(readxl)
```

## Problem 1

This problem focuses on NYC transit data. The dataset `NYC_Transit_Subway_Entrance_and_Exit_Data.csv` contains information related to each entrance and exit for each subway station in NYC.

#### Clean the data
``` {r message=FALSE}
# Step 1: Read and clean the data: retain line, station, name, station latitude / longitude, routes served, entry, vending, entrance type, and ADA compliance. Convert the entry variable from character (YES vs NO) to a logical variable (the ifelse or case_match function may be useful).

nyc_transit = 
  read_csv("data/NYC_Transit_Subway_Entrance_and_Exit_Data.csv") |> 
  janitor::clean_names() |> 
  select(line, station_name, station_latitude, station_longitude, route1:route11, entry, vending, entrance_type, ada) |> 
  mutate(
    entry = case_match(
      entry, 
      "YES" ~ TRUE, 
      "NO" ~ FALSE)
  )
```

#### Dataset Desciption

The dataset `NYC_Transit_Subway_Entrance_and_Exit_Data.csv` originally contains 32 columns and 1,868 rows. The variables include the line, name, station and entrance location by latitude and longitude, entrance type, ADA compliance, routes served, cross streets, vending availability, and more. The cleaned dataset `nyc_transit` contains a subset of the original dataset (with only 19 columns). `nyc_transit` variables include the line, station name, station latitude and longitude, routes served, entry, vending, entrance type, and ADA compliance. 

To clean the data, I started by cleaning the names, and then selected only the necessary columns as noted above. I then used the mutate function to convert the entry variable from a character type to a boolean type.

#### Answer questions about data

``` {r message=FALSE}
# How many distinct stations are there?
distinct_stations = 
  nyc_transit |> 
  distinct(station_name, line) |> 
  nrow()

# How many stations are ADA compliant?
ada_compliant = 
  nyc_transit |> 
  filter(ada==TRUE) |> 
  nrow()

# What proportion of station entrances / exits without vending allow entrance?
prop_vending_entrance = 
  nyc_transit |> 
  summarize(
    proportion = mean(vending == "NO" & entry == TRUE)
  )
```

There are `r distinct_stations` distinct stations. Out of the 1868 subway station entrances/exits in New York, `r ada_compliant` are ADA compliant. The proportion of station entrances / exits without vending that allow entrance is `r prop_vending_entrance`.

``` {r, message=FALSE}
# Reformat data so that route number and route name are distinct variables.
reformatted_nyc_transit = 
  nyc_transit |> 
  mutate(
    across(route1:route11, as.character)
  ) |> 
  pivot_longer(
    cols = route1:route11,
    names_to = "route_number",
    names_prefix = "route",
    values_to = "available_route"
  )


# How many distinct stations serve the A train?
A_train_service = 
  reformatted_nyc_transit |> 
  filter(available_route == "A") |> 
  distinct(station_name, line) |> 
  view()

nrow(A_train_service)

# Of the stations that serve the A train, how many are ADA compliant?
A_train_ADA =
  reformatted_nyc_transit |> 
  filter(ada == TRUE & available_route == "A") |> 
  distinct(station_name, line) |> 
  view()
  
nrow(A_train_ADA)
```


## Problem 2

Read and clean data!

``` {r message=FALSE}
# Read trash data as a function for all the common steps in each sheet
read_sheet_data = function(sheet_name) {
  sheet_data = 
    read_excel("data/202309 Trash Wheel Collection Data.xlsx", 
               sheet = sheet_name, # for each sheet
               na = c("NA", ".", ""), # remove NA columns
               skip = 1 # skip first row because it's a picture
    ) |> 
    janitor::clean_names() |>
    select(!homes_powered) # Remove columns that are not directly related to dumpster data for all sheets
  
  return(sheet_data)
}

# Read Mr. Trash Wheel Data
mr_trash_wheel = read_sheet_data("Mr. Trash Wheel") |> 
  select(!x15:x16) |> # Remove NA columns
  mutate(
    sports_balls = as.integer(round(sports_balls)) # Round number of sports balls to the closest integer
  )

# Read Professor Trash Wheel Data
professor_trash_wheel = read_sheet_data("Professor Trash Wheel")

# Read Gwynnda Trash Wheel Data
gwynnda_trash_wheel = read_sheet_data("Gwynnda Trash Wheel")
```

``` {r}

```





